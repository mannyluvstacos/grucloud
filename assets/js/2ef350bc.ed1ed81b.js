(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{105:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return c})),t.d(n,"metadata",(function(){return o})),t.d(n,"toc",(function(){return s})),t.d(n,"default",(function(){return l}));var r=t(3),a=t(8),i=(t(0),t(193)),c={id:"AwsGettingStarted",title:"Aws Getting Started"},o={unversionedId:"aws/AwsGettingStarted",id:"aws/AwsGettingStarted",isDocsHomePage:!1,title:"Aws Getting Started",description:"Let's create a simple infrastructure with one EC2 instance with the GruCloud AWS provider.",source:"@site/docs/aws/AwsGettingStarted.md",sourceDirName:"aws",slug:"/aws/AwsGettingStarted",permalink:"/docs/aws/AwsGettingStarted",version:"current",frontMatter:{id:"AwsGettingStarted",title:"Aws Getting Started"},sidebar:"docs",previous:{title:"What is GruCloud ?",permalink:"/docs/Introduction"},next:{title:"GCP Getting Started",permalink:"/docs/google/GoogleGettingStarted"}},s=[{value:"Requirements",id:"requirements",children:[{value:"Getting the GruCloud Command Line Interface",id:"getting-the-grucloud-command-line-interface",children:[]}]},{value:"Describing the instrustructure code and config",id:"describing-the-instrustructure-code-and-config",children:[{value:"Create a new project",id:"create-a-new-project",children:[]},{value:"Configuration",id:"configuration",children:[]},{value:"iac.js",id:"iacjs",children:[]}]},{value:"GruCloud CLI",id:"grucloud-cli",children:[{value:"Deploy",id:"deploy",children:[]},{value:"List",id:"list",children:[]},{value:"Destroy",id:"destroy",children:[]},{value:"Graph",id:"graph",children:[]}]}],p={toc:s};function l(e){var n=e.components,t=Object(a.a)(e,["components"]);return Object(i.b)("wrapper",Object(r.a)({},p,t,{components:n,mdxType:"MDXLayout"}),Object(i.b)("p",null,"Let's create a simple infrastructure with one ",Object(i.b)("a",{parentName:"p",href:"https://aws.amazon.com/ec2/"},"EC2 instance")," with the ",Object(i.b)("a",{parentName:"p",href:"https://www.npmjs.com/package/@grucloud/provider-aws"},"GruCloud AWS provider"),"."),Object(i.b)("h2",{id:"requirements"},"Requirements"),Object(i.b)("p",null,"Ensure the AWS CLI is configured properly.\nVisit the ",Object(i.b)("a",{parentName:"p",href:"/docs/aws/AwsRequirements"},"Aws Requirements")," to retrieve these informations."),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-sh"},"aws configure\n")),Object(i.b)("h3",{id:"getting-the-grucloud-command-line-interface"},"Getting the GruCloud Command Line Interface"),Object(i.b)("p",null,"GruCloud is a written in Javascript running on ",Object(i.b)("a",{parentName:"p",href:"https://nodejs.org/"},"NodeJs"),". Check if node is present on your system:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre"},"node --version\n")),Object(i.b)("blockquote",null,Object(i.b)("p",{parentName:"blockquote"},"The version must be greater than 14")),Object(i.b)("p",null,"Install the ",Object(i.b)("em",{parentName:"p"},"GrucCloud")," command line utility ",Object(i.b)("strong",{parentName:"p"},"gc")," with ",Object(i.b)("em",{parentName:"p"},"npm")),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-sh"},"npm i -g @grucloud/core\n")),Object(i.b)("p",null,"Check the current version of ",Object(i.b)("strong",{parentName:"p"},"gc"),":"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-sh"},"gc --version\n")),Object(i.b)("h2",{id:"describing-the-instrustructure-code-and-config"},"Describing the instrustructure code and config"),Object(i.b)("p",null,"In this section, we'll create the files needed to describe an infrastructure with GruCloud:"),Object(i.b)("ul",null,Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"package.json"),": specifies the npm dependencies and other informations."),Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"config.js"),": the config function."),Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"iac.js"),": exports ",Object(i.b)("em",{parentName:"li"},"createStack")," with provider and resources associated"),Object(i.b)("li",{parentName:"ul"},Object(i.b)("strong",{parentName:"li"},"hooks.js"),": optionnaly provides hook functions called after deployment or destruction.")),Object(i.b)("h3",{id:"create-a-new-project"},"Create a new project"),Object(i.b)("p",null,"Create a new directory, for instance ",Object(i.b)("inlineCode",{parentName:"p"},"ec2-example"),":"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-sh"},"mkdir ec2-example\ncd ec2-example\n")),Object(i.b)("p",null,"Let's create a new ",Object(i.b)("inlineCode",{parentName:"p"},"package.json")," with the ",Object(i.b)("inlineCode",{parentName:"p"},"npm init")," command:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre"},"npm init\n")),Object(i.b)("p",null,"Let's install the AWS provider ",Object(i.b)("a",{parentName:"p",href:"https://www.npmjs.com/package/@grucloud/provider-aws"},"@grucloud/provider-aws")," npm package, as well as the GruCloud core library ",Object(i.b)("inlineCode",{parentName:"p"},"@grucloud/core")),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-sh"},"npm install @grucloud/core @grucloud/provider-aws\n")),Object(i.b)("h3",{id:"configuration"},"Configuration"),Object(i.b)("p",null,"The configuration is a Javascript function located in ",Object(i.b)("em",{parentName:"p"},"config.js")),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-js"},'const pkg = require("./package.json");\nmodule.exports = ({ stage }) => ({\n  projectName: pkg.name,\n  ec2Instance: {\n    name: "web-server",\n    properties: () => ({\n      InstanceType: "t2.micro",\n      ImageId: "ami-00f6a0c18edb19300", // Ubuntu 18.04\n    }),\n  },\n});\n')),Object(i.b)("p",null,"You will have to find out the ",Object(i.b)("em",{parentName:"p"},"ImageId")," for your specific region. One way to retrieve to list of images with the aws cli:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-sh"},'aws ec2 describe-images --filters "Name=description,Values=Ubuntu Server 20.04 LTS" "Name=architecture,Values=x86_64"\n')),Object(i.b)("p",null,"We'll automate this step in a future episode with the help of the Image resource."),Object(i.b)("h3",{id:"iacjs"},"iac.js"),Object(i.b)("p",null,"Create a file called ",Object(i.b)("inlineCode",{parentName:"p"},"iac.js")," which stands for infrastructure as code.\nWe'll first import ",Object(i.b)("em",{parentName:"p"},"AwsProvider")," from ",Object(i.b)("a",{parentName:"p",href:"https://www.npmjs.com/package/@grucloud/provider-aws"},"@grucloud/provider-aws")),Object(i.b)("p",null,Object(i.b)("inlineCode",{parentName:"p"},"iac.js")," must exports the ",Object(i.b)("inlineCode",{parentName:"p"},"createStack")," function which returns the provider and the resources.\nWe instanciate ",Object(i.b)("em",{parentName:"p"},"AwsProvider")," by provider the ",Object(i.b)("em",{parentName:"p"},"config")," function.\nIn the case, an ",Object(i.b)("a",{parentName:"p",href:"https://www.grucloud.com/docs/aws/resources/EC2/EC2"},"EC2 Instance")," is defined with ",Object(i.b)("inlineCode",{parentName:"p"},"provider.makeEC2"),"."),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-js"},'// iac.js\nconst { AwsProvider } = require("@grucloud/provider-aws");\n\nexports.createStack = async ({}) => {\n  const provider = AwsProvider({ config: require("./config") });\n  const { config } = provider;\n  const ec2Instance = await provider.makeEC2({\n    name: config.ec2Instance.name,\n    properties: config.ec2Instance.properties,\n  });\n\n  return {\n    provider,\n    resources: { ec2Instance },\n  };\n};\n')),Object(i.b)("h2",{id:"grucloud-cli"},"GruCloud CLI"),Object(i.b)("h3",{id:"deploy"},"Deploy"),Object(i.b)("p",null,"We are ready to deploy with ",Object(i.b)("inlineCode",{parentName:"p"},"apply")," command:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-bash"},"gc apply\n")),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre"},"Querying resources on 1 provider: aws\n\u2713 aws\n  \u2713 Initialising\n  \u2713 Listing 6/6\n  \u2713 Querying\n    \u2713 EC2 1/1\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 1 EC2 from aws                                                           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Name       \u2502 Action   \u2502 Data                                             \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 web-server \u2502 CREATE   \u2502 InstanceType: t2.micro                           \u2502\n\u2502            \u2502          \u2502 ImageId: ami-00f6a0c18edb19300                   \u2502\n\u2502            \u2502          \u2502 MaxCount: 1                                      \u2502\n\u2502            \u2502          \u2502 MinCount: 1                                      \u2502\n\u2502            \u2502          \u2502 TagSpecifications:                               \u2502\n\u2502            \u2502          \u2502   - ResourceType: instance                       \u2502\n\u2502            \u2502          \u2502     Tags:                                        \u2502\n\u2502            \u2502          \u2502       - Key: Name                                \u2502\n\u2502            \u2502          \u2502         Value: web-server                        \u2502\n\u2502            \u2502          \u2502       - Key: ManagedBy                           \u2502\n\u2502            \u2502          \u2502         Value: GruCloud                          \u2502\n\u2502            \u2502          \u2502       - Key: CreatedByProvider                   \u2502\n\u2502            \u2502          \u2502         Value: aws                               \u2502\n\u2502            \u2502          \u2502       - Key: stage                               \u2502\n\u2502            \u2502          \u2502         Value: dev                               \u2502\n\u2502            \u2502          \u2502       - Key: projectName                         \u2502\n\u2502            \u2502          \u2502         Value: ec2-simple                        \u2502\n\u2502            \u2502          \u2502                                                  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Plan summary for provider aws                                           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 DEPLOY RESOURCES                                                        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 EC2                \u2502 web-server                                         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n? Are you sure to deploy 1 resource, 1 type on 1 provider? \u203a (y/N)\n")),Object(i.b)("p",null,"At this point, you are given the opportunity to look at what is going to be deployed.\nType ",Object(i.b)("inlineCode",{parentName:"p"},"y")," to accept:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre"},'Deploying resources on 1 provider: aws\n\u2713 aws\n  \u2713 Initialising\n  \u2713 Deploying\n    \u2713 EC2 1/1\n1 resource deployed of 1 type and 1 provider\nRunning OnDeployedGlobal resources on 1 provider: aws\nCommand "gc a" executed in 1m 29s\n')),Object(i.b)("h3",{id:"list"},"List"),Object(i.b)("p",null,"To list the resources that have been deployed, use the ",Object(i.b)("inlineCode",{parentName:"p"},"gc list")," command:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre"},"gc list --our\n")),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre"},'Listing resources on 1 provider: aws\n\u2713 aws\n  \u2713 Initialising\n  \u2713 Listing 6/6\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 1 EC2 from aws                                                           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Name       \u2502 Data                                                 \u2502 Our  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 web-server \u2502 AmiLaunchIndex: 0                                    \u2502 Yes  \u2502\n\u2502            \u2502 ImageId: ami-00f6a0c18edb19300                       \u2502      \u2502\n\u2502            \u2502 InstanceId: i-094ea36963d8b649b                      \u2502      \u2502\n\u2502            \u2502 InstanceType: t2.micro                               \u2502      \u2502\n\u2502            \u2502 LaunchTime: 2021-04-15T02:36:09.000Z                 \u2502      \u2502\n\u2502            \u2502 Monitoring:                                          \u2502      \u2502\n\u2502            \u2502   State: disabled                                    \u2502      \u2502\n\u2502            \u2502 Placement:                                           \u2502      \u2502\n\u2502            \u2502   AvailabilityZone: eu-west-2a                       \u2502      \u2502\n\u2502            \u2502   GroupName:                                         \u2502      \u2502\n\u2502            \u2502   Tenancy: default                                   \u2502      \u2502\n\u2502            \u2502 PrivateDnsName: ip-172-31-8-176.eu-west-2.compute.i\u2026 \u2502      \u2502\n\u2502            \u2502 PrivateIpAddress: 172.31.8.176                       \u2502      \u2502\n\u2502            \u2502 ProductCodes: []                                     \u2502      \u2502\n\u2502            \u2502 PublicDnsName: ec2-35-178-63-237.eu-west-2.compute.\u2026 \u2502      \u2502\n\u2502            \u2502 PublicIpAddress: 35.178.63.237                       \u2502      \u2502\n\u2502            \u2502 State:                                               \u2502      \u2502\n\u2502            \u2502   Code: 16                                           \u2502      \u2502\n\u2502            \u2502   Name: running                                      \u2502      \u2502\n\u2502            \u2502 StateTransitionReason:                               \u2502      \u2502\n\u2502            \u2502 SubnetId: subnet-0f6f085fc384bf8ce                   \u2502      \u2502\n\u2502            \u2502 VpcId: vpc-bbbafcd3                                  \u2502      \u2502\n\u2502            \u2502 Architecture: x86_64                                 \u2502      \u2502\n\u2502            \u2502 BlockDeviceMappings:                                 \u2502      \u2502\n\u2502            \u2502   - DeviceName: /dev/sda1                            \u2502      \u2502\n\u2502            \u2502     Ebs:                                             \u2502      \u2502\n\u2502            \u2502       AttachTime: 2021-04-15T02:36:10.000Z           \u2502      \u2502\n\u2502            \u2502       DeleteOnTermination: true                      \u2502      \u2502\n\u2502            \u2502       Status: attached                               \u2502      \u2502\n\u2502            \u2502       VolumeId: vol-0b16e59c9d0e50349                \u2502      \u2502\n\u2502            \u2502 ClientToken: 7f9b32cf-ca3d-4657-b431-ad87204e857e    \u2502      \u2502\n\u2502            \u2502 EbsOptimized: false                                  \u2502      \u2502\n\u2502            \u2502 EnaSupport: true                                     \u2502      \u2502\n\u2502            \u2502 Hypervisor: xen                                      \u2502      \u2502\n\u2502            \u2502 ElasticGpuAssociations: []                           \u2502      \u2502\n\u2502            \u2502 ElasticInferenceAcceleratorAssociations: []          \u2502      \u2502\n\u2502            \u2502 NetworkInterfaces:                                   \u2502      \u2502\n\u2502            \u2502   - Association:                                     \u2502      \u2502\n\u2502            \u2502       IpOwnerId: amazon                              \u2502      \u2502\n\u2502            \u2502       PublicDnsName: ec2-35-178-63-237.eu-west-2.co\u2026 \u2502      \u2502\n\u2502            \u2502       PublicIp: 35.178.63.237                        \u2502      \u2502\n\u2502            \u2502     Attachment:                                      \u2502      \u2502\n\u2502            \u2502       AttachTime: 2021-04-15T02:36:09.000Z           \u2502      \u2502\n\u2502            \u2502       AttachmentId: eni-attach-0da7cd7b764a97a37     \u2502      \u2502\n\u2502            \u2502       DeleteOnTermination: true                      \u2502      \u2502\n\u2502            \u2502       DeviceIndex: 0                                 \u2502      \u2502\n\u2502            \u2502       Status: attached                               \u2502      \u2502\n\u2502            \u2502     Description:                                     \u2502      \u2502\n\u2502            \u2502     Groups:                                          \u2502      \u2502\n\u2502            \u2502       - GroupName: default                           \u2502      \u2502\n\u2502            \u2502         GroupId: sg-f4139a96                         \u2502      \u2502\n\u2502            \u2502     Ipv6Addresses: []                                \u2502      \u2502\n\u2502            \u2502     MacAddress: 06:5d:b6:ea:0b:b2                    \u2502      \u2502\n\u2502            \u2502     NetworkInterfaceId: eni-05813eeec4cd3a498        \u2502      \u2502\n\u2502            \u2502     OwnerId: 840541460064                            \u2502      \u2502\n\u2502            \u2502     PrivateDnsName: ip-172-31-8-176.eu-west-2.compu\u2026 \u2502      \u2502\n\u2502            \u2502     PrivateIpAddress: 172.31.8.176                   \u2502      \u2502\n\u2502            \u2502     PrivateIpAddresses:                              \u2502      \u2502\n\u2502            \u2502       - Association:                                 \u2502      \u2502\n\u2502            \u2502           IpOwnerId: amazon                          \u2502      \u2502\n\u2502            \u2502           PublicDnsName: ec2-35-178-63-237.eu-west-\u2026 \u2502      \u2502\n\u2502            \u2502           PublicIp: 35.178.63.237                    \u2502      \u2502\n\u2502            \u2502         Primary: true                                \u2502      \u2502\n\u2502            \u2502         PrivateDnsName: ip-172-31-8-176.eu-west-2.c\u2026 \u2502      \u2502\n\u2502            \u2502         PrivateIpAddress: 172.31.8.176               \u2502      \u2502\n\u2502            \u2502     SourceDestCheck: true                            \u2502      \u2502\n\u2502            \u2502     Status: in-use                                   \u2502      \u2502\n\u2502            \u2502     SubnetId: subnet-0f6f085fc384bf8ce               \u2502      \u2502\n\u2502            \u2502     VpcId: vpc-bbbafcd3                              \u2502      \u2502\n\u2502            \u2502     InterfaceType: interface                         \u2502      \u2502\n\u2502            \u2502 RootDeviceName: /dev/sda1                            \u2502      \u2502\n\u2502            \u2502 RootDeviceType: ebs                                  \u2502      \u2502\n\u2502            \u2502 SecurityGroups:                                      \u2502      \u2502\n\u2502            \u2502   - GroupName: default                               \u2502      \u2502\n\u2502            \u2502     GroupId: sg-f4139a96                             \u2502      \u2502\n\u2502            \u2502 SourceDestCheck: true                                \u2502      \u2502\n\u2502            \u2502 Tags:                                                \u2502      \u2502\n\u2502            \u2502   - Key: Name                                        \u2502      \u2502\n\u2502            \u2502     Value: web-server                                \u2502      \u2502\n\u2502            \u2502   - Key: stage                                       \u2502      \u2502\n\u2502            \u2502     Value: dev                                       \u2502      \u2502\n\u2502            \u2502   - Key: projectName                                 \u2502      \u2502\n\u2502            \u2502     Value: ec2-simple                                \u2502      \u2502\n\u2502            \u2502   - Key: CreatedByProvider                           \u2502      \u2502\n\u2502            \u2502     Value: aws                                       \u2502      \u2502\n\u2502            \u2502   - Key: ManagedBy                                   \u2502      \u2502\n\u2502            \u2502     Value: GruCloud                                  \u2502      \u2502\n\u2502            \u2502 VirtualizationType: hvm                              \u2502      \u2502\n\u2502            \u2502 CpuOptions:                                          \u2502      \u2502\n\u2502            \u2502   CoreCount: 1                                       \u2502      \u2502\n\u2502            \u2502   ThreadsPerCore: 1                                  \u2502      \u2502\n\u2502            \u2502 CapacityReservationSpecification:                    \u2502      \u2502\n\u2502            \u2502   CapacityReservationPreference: open                \u2502      \u2502\n\u2502            \u2502 HibernationOptions:                                  \u2502      \u2502\n\u2502            \u2502   Configured: false                                  \u2502      \u2502\n\u2502            \u2502 Licenses: []                                         \u2502      \u2502\n\u2502            \u2502 MetadataOptions:                                     \u2502      \u2502\n\u2502            \u2502   State: applied                                     \u2502      \u2502\n\u2502            \u2502   HttpTokens: optional                               \u2502      \u2502\n\u2502            \u2502   HttpPutResponseHopLimit: 1                         \u2502      \u2502\n\u2502            \u2502   HttpEndpoint: enabled                              \u2502      \u2502\n\u2502            \u2502 EnclaveOptions:                                      \u2502      \u2502\n\u2502            \u2502   Enabled: false                                     \u2502      \u2502\n\u2502            \u2502                                                      \u2502      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\nList Summary:\nProvider: aws\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 aws                                                                     \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 EC2                \u2502 web-server                                         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n1 resource, 1 type, 1 provider\nCommand "gc list --our" executed in 6s\n\n')),Object(i.b)("blockquote",null,Object(i.b)("p",{parentName:"blockquote"},"Note that tags have been added to the EC2 Instance, it gives GruCloud a way to identify the resources under its control. Unlike other instructure as code tool such as Terraform and Pulumi, GruCloud does not need a ",Object(i.b)("em",{parentName:"p"},"state")," file. Hence removing a lot a complexity and issues.")),Object(i.b)("h3",{id:"destroy"},"Destroy"),Object(i.b)("p",null,"Time to destroy the resources allocated and therefore save a lot of \xa3$\u20ac."),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre",className:"language-bash"},"gc destroy\n")),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre"},"Find Deletable resources on 1 provider: aws\n\u2713 aws\n  \u2713 Initialising\n  \u2713 Listing 6/6\n? Are you sure to destroy 1 resource, 1 type on 1 provider? \u203a (y/N)\n\n")),Object(i.b)("p",null,"Once again, you are given the opportunity to look at what is going to be destroyed.\nType 'y' to confirm the destruction:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre"},'Destroying resources on 1 provider: aws\n\u2713 aws\n  \u2713 Initialising\n  \u2713 Destroying\n    \u2713 EC2 1/1\n1 resource destroyed, 1 type on 1 provider\nRunning OnDestroyedGlobal resources on 1 provider: aws\nCommand "gc destroy" executed in 1m 29s\n')),Object(i.b)("p",null,"Let's run the ",Object(i.b)("inlineCode",{parentName:"p"},"gc list")," command with the ",Object(i.b)("inlineCode",{parentName:"p"},"E2")," filter to verify the EC2 is gone:"),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre"},"gc l -t EC2\n")),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre"},'Listing resources on 1 provider: aws\n\u2713 aws\n  \u2713 Initialising\n  \u2713 Listing 6/6\nList Summary:\nProvider: aws\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 aws                                                                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n0 resources, 0 types, 1 provider\nCommand "gc list -t EC2" executed in 3s\n')),Object(i.b)("p",null,"This example demonstrates how to code a very basic infrastructure with one EC2 instance, and how can we use the ",Object(i.b)("inlineCode",{parentName:"p"},"gc apply"),", ",Object(i.b)("inlineCode",{parentName:"p"},"gc list"),", ",Object(i.b)("inlineCode",{parentName:"p"},"gc destroy")," and ",Object(i.b)("inlineCode",{parentName:"p"},"gc graph")," to manage the instrastructure."),Object(i.b)("p",null,"It paves the way for more ",Object(i.b)("a",{parentName:"p",href:"https://www.grucloud.com/docs/aws/AwsExamples"},"AWS examples")),Object(i.b)("h3",{id:"graph"},"Graph"),Object(i.b)("p",null,"A picture is worth a thousand words, GruCloud generate SVG file describing the resources and their relationship."),Object(i.b)("pre",null,Object(i.b)("code",{parentName:"pre"},"gc graph\n")),Object(i.b)("p",null,"Here is the graph of a tipical web application managed by Kubernetes running on AWS where the master node is managed by EKS."),Object(i.b)("p",null,Object(i.b)("img",{parentName:"p",src:"https://raw.githubusercontent.com/grucloud/grucloud/main/examples/starhackit/eks-lean/diagram-target.svg",alt:"kubernetes eks"})))}l.isMDXComponent=!0},193:function(e,n,t){"use strict";t.d(n,"a",(function(){return u})),t.d(n,"b",(function(){return m}));var r=t(0),a=t.n(r);function i(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function c(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,r)}return t}function o(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?c(Object(t),!0).forEach((function(n){i(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):c(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,r,a=function(e,n){if(null==e)return{};var t,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||(a[t]=e[t]);return a}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)t=i[r],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var p=a.a.createContext({}),l=function(e){var n=a.a.useContext(p),t=n;return e&&(t="function"==typeof e?e(n):o(o({},n),e)),t},u=function(e){var n=l(e.components);return a.a.createElement(p.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.a.createElement(a.a.Fragment,{},n)}},b=a.a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,i=e.originalType,c=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),u=l(t),b=r,m=u["".concat(c,".").concat(b)]||u[b]||d[b]||i;return t?a.a.createElement(m,o(o({ref:n},p),{},{components:t})):a.a.createElement(m,o({ref:n},p))}));function m(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var i=t.length,c=new Array(i);c[0]=b;var o={};for(var s in n)hasOwnProperty.call(n,s)&&(o[s]=n[s]);o.originalType=e,o.mdxType="string"==typeof e?e:r,c[1]=o;for(var p=2;p<i;p++)c[p]=t[p];return a.a.createElement.apply(null,c)}return a.a.createElement.apply(null,t)}b.displayName="MDXCreateElement"}}]);