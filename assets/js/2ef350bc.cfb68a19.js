(window.webpackJsonp=window.webpackJsonp||[]).push([[35],{105:function(e,n,t){"use strict";t.r(n),t.d(n,"frontMatter",(function(){return o})),t.d(n,"metadata",(function(){return i})),t.d(n,"toc",(function(){return s})),t.d(n,"default",(function(){return p}));var a=t(3),r=t(8),c=(t(0),t(197)),o={},i={unversionedId:"aws/AwsGettingStarted",id:"aws/AwsGettingStarted",isDocsHomePage:!1,title:"AwsGettingStarted",description:"This tutorial explains the deployment automation of a simple AWS EC2 instance with the GruCloud AWS provider.",source:"@site/docs/aws/AwsGettingStarted.md",sourceDirName:"aws",slug:"/aws/AwsGettingStarted",permalink:"/docs/aws/AwsGettingStarted",version:"current",frontMatter:{},sidebar:"docs",previous:{title:"What is GruCloud ?",permalink:"/docs/Introduction"},next:{title:"GCP Getting Started",permalink:"/docs/google/GoogleGettingStarted"}},s=[{value:"Requirements",id:"requirements",children:[{value:"AWS Account",id:"aws-account",children:[]},{value:"AWS CLI",id:"aws-cli",children:[]},{value:"Access and Secret Key",id:"access-and-secret-key",children:[]},{value:"Configure AWS CLI",id:"configure-aws-cli",children:[]},{value:"Getting the GruCloud CLI",id:"getting-the-grucloud-cli",children:[]}]},{value:"Code Architecture",id:"code-architecture",children:[{value:"Create a new project",id:"create-a-new-project",children:[]},{value:"package.json",id:"packagejson",children:[]},{value:"config.js",id:"configjs",children:[]},{value:"iac.js",id:"iacjs",children:[]}]},{value:"GruCloud CLI",id:"grucloud-cli",children:[{value:"Info",id:"info",children:[]},{value:"Deploy",id:"deploy",children:[]},{value:"List",id:"list",children:[]},{value:"Update",id:"update",children:[]},{value:"Output",id:"output",children:[]},{value:"Destroy",id:"destroy",children:[]},{value:"Graph",id:"graph",children:[]}]}],l={toc:s};function p(e){var n=e.components,t=Object(r.a)(e,["components"]);return Object(c.b)("wrapper",Object(a.a)({},l,t,{components:n,mdxType:"MDXLayout"}),Object(c.b)("p",null,"This tutorial explains the deployment automation of a simple ",Object(c.b)("a",{parentName:"p",href:"https://aws.amazon.com/ec2/"},"AWS EC2 instance")," with the ",Object(c.b)("a",{parentName:"p",href:"https://www.npmjs.com/package/@grucloud/provider-aws"},"GruCloud AWS provider"),"."),Object(c.b)("p",null,"Instead of manually creating, updating, and destroying EC2 instances, the infrastructure will be described as Javascript code. The GruCloud CLI then reads this code, retrieves the lives resources through the AWS API, and decides what needs to be created, updated, or destroyed."),Object(c.b)("p",null,Object(c.b)("img",{parentName:"p",src:"https://raw.githubusercontent.com/grucloud/grucloud/main/examples/aws/ec2-simple/diagram-target.svg",alt:"graph-diagram-ec2.svg"})),Object(c.b)("h2",{id:"requirements"},"Requirements"),Object(c.b)("h3",{id:"aws-account"},"AWS Account"),Object(c.b)("p",null,"Ensure access to the ",Object(c.b)("a",{parentName:"p",href:"https://console.aws.amazon.com"},"Amazon Console")," and create an account if necessary."),Object(c.b)("h3",{id:"aws-cli"},"AWS CLI"),Object(c.b)("p",null,"Ensure the ",Object(c.b)("em",{parentName:"p"},"AWS CLI")," is installed and configured:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-sh"},"aws --version\n")),Object(c.b)("p",null,"If not, visit ",Object(c.b)("a",{parentName:"p",href:"https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2.html"},"https://docs.aws.amazon.com/cli/latest/userguide/install-cliv2.html")),Object(c.b)("h3",{id:"access-and-secret-key"},"Access and Secret Key"),Object(c.b)("p",null,"Visit the ",Object(c.b)("a",{parentName:"p",href:"https://console.aws.amazon.com/iam/home#/security_credentials"},"security credentials")),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},"Click on ",Object(c.b)("strong",{parentName:"li"},"Access key (access key ID and secret access key).")),Object(c.b)("li",{parentName:"ul"},"Click on the button ",Object(c.b)("strong",{parentName:"li"},"Create New Access Key"),".")),Object(c.b)("p",null,"Write down the ",Object(c.b)("strong",{parentName:"p"},"AWSAccessKeyId")," and ",Object(c.b)("strong",{parentName:"p"},"AWSSecretKey")),Object(c.b)("blockquote",null,Object(c.b)("p",{parentName:"blockquote"},"In a further episode, the access and secret key will be obtained from a dedicated IAM user with the correct role and policy.")),Object(c.b)("h3",{id:"configure-aws-cli"},"Configure AWS CLI"),Object(c.b)("p",null,"Configure the account with the previously obtained ",Object(c.b)("strong",{parentName:"p"},"AWSAccessKeyId")," and ",Object(c.b)("strong",{parentName:"p"},"AWSSecretKey"),", as well as the region, for instance ",Object(c.b)("inlineCode",{parentName:"p"},"us-east-1")),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"aws configure\n")),Object(c.b)("h3",{id:"getting-the-grucloud-cli"},"Getting the GruCloud CLI"),Object(c.b)("p",null,"GruCloud is written in Javascript running on ",Object(c.b)("a",{parentName:"p",href:"https://nodejs.org/"},"Node.js"),". Check if ",Object(c.b)("inlineCode",{parentName:"p"},"node")," is present on your system:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"node --version\n")),Object(c.b)("blockquote",null,Object(c.b)("p",{parentName:"blockquote"},"The version must be greater than 14")),Object(c.b)("p",null,"Install the ",Object(c.b)("em",{parentName:"p"},"GrucCloud")," command-line utility ",Object(c.b)("strong",{parentName:"p"},"gc")," with ",Object(c.b)("em",{parentName:"p"},"npm")),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-sh"},"npm i -g @grucloud/core\n")),Object(c.b)("p",null,"Check the current version of ",Object(c.b)("strong",{parentName:"p"},"gc"),":"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-sh"},"gc --version\n")),Object(c.b)("h2",{id:"code-architecture"},"Code Architecture"),Object(c.b)("p",null,"In this section, we'll create the files needed to describe an infrastructure with GruCloud:"),Object(c.b)("ul",null,Object(c.b)("li",{parentName:"ul"},Object(c.b)("a",{parentName:"li",href:"https://github.com/grucloud/grucloud/blob/main/examples/aws/ec2-simple/package.json"},"package.json"),": specifies the npm dependencies and other information."),Object(c.b)("li",{parentName:"ul"},Object(c.b)("a",{parentName:"li",href:"https://github.com/grucloud/grucloud/blob/main/examples/aws/ec2-simple/config.js"},"config.js"),": the config function."),Object(c.b)("li",{parentName:"ul"},Object(c.b)("a",{parentName:"li",href:"https://github.com/grucloud/grucloud/blob/main/examples/aws/ec2-simple/iac.js"},"iac.js"),": exports ",Object(c.b)("em",{parentName:"li"},"createStack")," with provider and resources associated"),Object(c.b)("li",{parentName:"ul"},Object(c.b)("a",{parentName:"li",href:"https://github.com/grucloud/grucloud/blob/main/examples/aws/ec2-simple/hook.js"},"hooks.js"),": optionally provides hook functions called after deployment or destruction.")),Object(c.b)("blockquote",null,Object(c.b)("p",{parentName:"blockquote"},"The ",Object(c.b)("a",{parentName:"p",href:"https://github.com/grucloud/grucloud/tree/main/examples/aws/ec2-simple"},"source code")," for this example in on GitHub.")),Object(c.b)("h3",{id:"create-a-new-project"},"Create a new project"),Object(c.b)("p",null,"Create a new directory, for instance ",Object(c.b)("inlineCode",{parentName:"p"},"ec2-example"),":"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-sh"},"mkdir ec2-example\ncd ec2-example\n")),Object(c.b)("h3",{id:"packagejson"},"package.json"),Object(c.b)("p",null,"Let's create a new ",Object(c.b)("inlineCode",{parentName:"p"},"package.json")," with the ",Object(c.b)("inlineCode",{parentName:"p"},"npm init")," command:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-sh"},"npm init\n")),Object(c.b)("p",null,"Let's install the GruCloud AWS provider called ",Object(c.b)("a",{parentName:"p",href:"https://www.npmjs.com/package/@grucloud/provider-aws"},"@grucloud/provider-aws"),", as well as the GruCloud core library ",Object(c.b)("inlineCode",{parentName:"p"},"@grucloud/core"),"."),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-sh"},"npm install @grucloud/core @grucloud/provider-aws\n")),Object(c.b)("h3",{id:"configjs"},"config.js"),Object(c.b)("p",null,"The configuration is a Javascript function located in ",Object(c.b)("a",{parentName:"p",href:"https://github.com/grucloud/grucloud/blob/main/examples/aws/ec2-simple/config.js"},"config.js")),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-js"},'// config.js\nconst pkg = require("./package.json");\nmodule.exports = ({ stage }) => ({\n  projectName: pkg.name,\n  ec2Instance: {\n    name: "web-server",\n    properties: {\n      InstanceType: "t2.micro",\n      ImageId: "ami-00f6a0c18edb19300", // Ubuntu 18.04\n    },\n  },\n});\n')),Object(c.b)("p",null,"You will have to find out the ",Object(c.b)("inlineCode",{parentName:"p"},"ImageId")," for your specific region. One way to retrieve to list of images is with the ",Object(c.b)("em",{parentName:"p"},"aws cli"),":"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-sh"},'aws ec2 describe-images --filters "Name=description,Values=Ubuntu Server 20.04 LTS" "Name=architecture,Values=x86_64"\n')),Object(c.b)("blockquote",null,Object(c.b)("p",{parentName:"blockquote"},"This step will be automated in a future episode with the help of the ",Object(c.b)("a",{parentName:"p",href:"https://www.grucloud.com/docs/aws/resources/EC2/Image"},"Amazon Managed Image")," resource.")),Object(c.b)("h3",{id:"iacjs"},"iac.js"),Object(c.b)("p",null,"Create a file called ",Object(c.b)("inlineCode",{parentName:"p"},"iac.js")," which stands for ",Object(c.b)("em",{parentName:"p"},"infrastructure as code"),".\nWe'll first import ",Object(c.b)("em",{parentName:"p"},"AwsProvider")," from ",Object(c.b)("a",{parentName:"p",href:"https://www.npmjs.com/package/@grucloud/provider-aws"},"@grucloud/provider-aws")),Object(c.b)("p",null,Object(c.b)("a",{parentName:"p",href:"https://github.com/grucloud/grucloud/blob/main/examples/aws/ec2-simple/iac.js"},"iac.js")," must export the ",Object(c.b)("inlineCode",{parentName:"p"},"createStack")," function which returns the provider and the resources."),Object(c.b)("p",null,"Then, instantiate ",Object(c.b)("em",{parentName:"p"},"AwsProvider")," by providing the ",Object(c.b)("em",{parentName:"p"},"config")," function."),Object(c.b)("p",null,"In the case, an ",Object(c.b)("a",{parentName:"p",href:"https://www.grucloud.com/docs/aws/resources/EC2/EC2"},"EC2 Instance")," is defined with ",Object(c.b)("inlineCode",{parentName:"p"},"provider.makeEC2"),"."),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-js"},'// iac.js\nconst { AwsProvider } = require("@grucloud/provider-aws");\n\nexports.createStack = async ({ stage }) => {\n  const provider = AwsProvider({ config: require("./config"), stage });\n  const { config } = provider;\n  const ec2Instance = await provider.makeEC2({\n    name: config.ec2Instance.name,\n    properties: () => config.ec2Instance.properties,\n  });\n\n  return {\n    provider,\n    resources: { ec2Instance },\n  };\n};\n')),Object(c.b)("h2",{id:"grucloud-cli"},"GruCloud CLI"),Object(c.b)("h3",{id:"info"},"Info"),Object(c.b)("p",null,"As a way to verify that ",Object(c.b)("strong",{parentName:"p"},"gc")," can connect to the AWS API, one can use the ",Object(c.b)("inlineCode",{parentName:"p"},"info")," command:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-sh"},"gc info\n")),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-txt"},'  - provider:\n      name: aws\n      type: aws\n    accountId: 840541460064\n    zone: eu-west-2a\n    config:\n      projectName: ec2-simple\n      ec2Instance:\n        name: web-server\n        properties:\n          InstanceType: t2.micro\n          ImageId: ami-00f6a0c18edb19300\n      stage: dev\n      region: eu-west-2\n\nCommand "gc info" executed in 1s\n')),Object(c.b)("h3",{id:"deploy"},"Deploy"),Object(c.b)("p",null,"We are ready to deploy with ",Object(c.b)("inlineCode",{parentName:"p"},"apply")," command:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-bash"},"gc apply\n")),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"Querying resources on 1 provider: aws\n\u2713 aws\n  \u2713 Initialising\n  \u2713 Listing 6/6\n  \u2713 Querying\n    \u2713 EC2 1/1\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 1 EC2 from aws                                                           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Name       \u2502 Action   \u2502 Data                                             \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 web-server \u2502 CREATE   \u2502 InstanceType: t2.micro                           \u2502\n\u2502            \u2502          \u2502 ImageId: ami-00f6a0c18edb19300                   \u2502\n\u2502            \u2502          \u2502 MaxCount: 1                                      \u2502\n\u2502            \u2502          \u2502 MinCount: 1                                      \u2502\n\u2502            \u2502          \u2502 TagSpecifications:                               \u2502\n\u2502            \u2502          \u2502   - ResourceType: instance                       \u2502\n\u2502            \u2502          \u2502     Tags:                                        \u2502\n\u2502            \u2502          \u2502       - Key: Name                                \u2502\n\u2502            \u2502          \u2502         Value: web-server                        \u2502\n\u2502            \u2502          \u2502       - Key: ManagedBy                           \u2502\n\u2502            \u2502          \u2502         Value: GruCloud                          \u2502\n\u2502            \u2502          \u2502       - Key: CreatedByProvider                   \u2502\n\u2502            \u2502          \u2502         Value: aws                               \u2502\n\u2502            \u2502          \u2502       - Key: stage                               \u2502\n\u2502            \u2502          \u2502         Value: dev                               \u2502\n\u2502            \u2502          \u2502       - Key: projectName                         \u2502\n\u2502            \u2502          \u2502         Value: ec2-simple                        \u2502\n\u2502            \u2502          \u2502                                                  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Plan summary for provider aws                                           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 DEPLOY RESOURCES                                                        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 EC2                \u2502 web-server                                         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n? Are you sure to deploy 1 resource, 1 type on 1 provider? \u203a (y/N)\n")),Object(c.b)("p",null,"At this point, you are given the opportunity to look at what is going to be deployed.\nType ",Object(c.b)("inlineCode",{parentName:"p"},"y")," to accept:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},'Deploying resources on 1 provider: aws\n\u2713 aws\n  \u2713 Initialising\n  \u2713 Deploying\n    \u2713 EC2 1/1\n1 resource deployed of 1 type and 1 provider\nRunning OnDeployedGlobal resources on 1 provider: aws\nCommand "gc a" executed in 1m 29s\n')),Object(c.b)("p",null,"When ",Object(c.b)("inlineCode",{parentName:"p"},"gc apply")," is executed a second time, resources should not be created or destroyed."),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-sh"},"gc a\n")),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-txt"},'Querying resources on 1 provider: aws\n\u2713 aws\n  \u2713 Initialising\n  \u2713 Listing 13/13\n  \u2713 Querying\n    \u2713 EC2 1/1\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Plan summary for provider aws                                                           \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\nNothing to deploy\nRunning OnDeployedGlobal resources on 1 provider: aws\nCommand "gc a" executed in 9s\n')),Object(c.b)("p",null,"As expected, nothing to deploy, the target resources defined in the code match the live resources."),Object(c.b)("h3",{id:"list"},"List"),Object(c.b)("p",null,"To list all the resources, and generate a diagram:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"gc list --graph --all\n")),Object(c.b)("p",null,"This will include the default AWS resources such as VPC, subnet, internet gateway, and security group."),Object(c.b)("p",null,Object(c.b)("img",{parentName:"p",src:"https://raw.githubusercontent.com/grucloud/grucloud/main/examples/aws/ec2-simple/diagram-live.svg",alt:"graph-live"})),Object(c.b)("p",null,"To list only the resources created by GruCloud:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"gc list --our\n")),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-txt"},'Listing resources on 1 provider: aws\n\u2713 aws\n  \u2713 Initialising\n  \u2713 Listing 13/13\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 1 EC2 from aws                                                                                          \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Name       \u2502 Data                                                                                \u2502 Our  \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 web-server \u2502 AmiLaunchIndex: 0                                                                   \u2502 Yes  \u2502\n\u2502            \u2502 ImageId: ami-00f6a0c18edb19300                                                      \u2502      \u2502\n\u2502            \u2502 InstanceId: i-016628a1b6a6a2f91                                                     \u2502      \u2502\n\u2502            \u2502 InstanceType: t3.micro                                                              \u2502      \u2502\n\u2502            \u2502 LaunchTime: 2021-04-29T23:10:44.000Z                                                \u2502      \u2502\n\u2502            \u2502 Monitoring:                                                                         \u2502      \u2502\n\u2502            \u2502   State: disabled                                                                   \u2502      \u2502\n\u2502            \u2502 Placement:                                                                          \u2502      \u2502\n\u2502            \u2502   AvailabilityZone: eu-west-2a                                                      \u2502      \u2502\n\u2502            \u2502   GroupName:                                                                        \u2502      \u2502\n\u2502            \u2502   Tenancy: default                                                                  \u2502      \u2502\n\u2502            \u2502 PrivateDnsName: ip-172-31-2-146.eu-west-2.compute.internal                          \u2502      \u2502\n\u2502            \u2502 PrivateIpAddress: 172.31.2.146                                                      \u2502      \u2502\n\u2502            \u2502 ProductCodes: []                                                                    \u2502      \u2502\n\u2502            \u2502 PublicDnsName: ec2-18-132-98-216.eu-west-2.compute.amazonaws.com                    \u2502      \u2502\n\u2502            \u2502 PublicIpAddress: 18.132.98.216                                                      \u2502      \u2502\n\u2502            \u2502 State:                                                                              \u2502      \u2502\n\u2502            \u2502   Code: 16                                                                          \u2502      \u2502\n\u2502            \u2502   Name: running                                                                     \u2502      \u2502\n\u2502            \u2502 StateTransitionReason:                                                              \u2502      \u2502\n\u2502            \u2502 SubnetId: subnet-0f6f085fc384bf8ce                                                  \u2502      \u2502\n\u2502            \u2502 VpcId: vpc-bbbafcd3                                                                 \u2502      \u2502\n\u2502            \u2502 Architecture: x86_64                                                                \u2502      \u2502\n\u2502            \u2502 BlockDeviceMappings:                                                                \u2502      \u2502\n\u2502            \u2502   - DeviceName: /dev/sda1                                                           \u2502      \u2502\n\u2502            \u2502     Ebs:                                                                            \u2502      \u2502\n\u2502            \u2502       AttachTime: 2021-04-29T23:10:45.000Z                                          \u2502      \u2502\n\u2502            \u2502       DeleteOnTermination: true                                                     \u2502      \u2502\n\u2502            \u2502       Status: attached                                                              \u2502      \u2502\n\u2502            \u2502       VolumeId: vol-0a88a34248fe18740                                               \u2502      \u2502\n\u2502            \u2502 ClientToken: 7ef5fd60-e962-400f-a2b9-37719d8329ed                                   \u2502      \u2502\n\u2502            \u2502 EbsOptimized: false                                                                 \u2502      \u2502\n\u2502            \u2502 EnaSupport: true                                                                    \u2502      \u2502\n\u2502            \u2502 Hypervisor: xen                                                                     \u2502      \u2502\n\u2502            \u2502 ElasticGpuAssociations: []                                                          \u2502      \u2502\n\u2502            \u2502 ElasticInferenceAcceleratorAssociations: []                                         \u2502      \u2502\n\u2502            \u2502 NetworkInterfaces:                                                                  \u2502      \u2502\n\u2502            \u2502   - Association:                                                                    \u2502      \u2502\n\u2502            \u2502       IpOwnerId: amazon                                                             \u2502      \u2502\n\u2502            \u2502       PublicDnsName: ec2-18-132-98-216.eu-west-2.compute.amazonaws.com              \u2502      \u2502\n\u2502            \u2502       PublicIp: 18.132.98.216                                                       \u2502      \u2502\n\u2502            \u2502     Attachment:                                                                     \u2502      \u2502\n\u2502            \u2502       AttachTime: 2021-04-29T23:10:44.000Z                                          \u2502      \u2502\n\u2502            \u2502       AttachmentId: eni-attach-02744addcff43ecbb                                    \u2502      \u2502\n\u2502            \u2502       DeleteOnTermination: true                                                     \u2502      \u2502\n\u2502            \u2502       DeviceIndex: 0                                                                \u2502      \u2502\n\u2502            \u2502       Status: attached                                                              \u2502      \u2502\n\u2502            \u2502       NetworkCardIndex: 0                                                           \u2502      \u2502\n\u2502            \u2502     Description:                                                                    \u2502      \u2502\n\u2502            \u2502     Groups:                                                                         \u2502      \u2502\n\u2502            \u2502       - GroupName: default                                                          \u2502      \u2502\n\u2502            \u2502         GroupId: sg-f4139a96                                                        \u2502      \u2502\n\u2502            \u2502     Ipv6Addresses: []                                                               \u2502      \u2502\n\u2502            \u2502     MacAddress: 06:ee:ef:d7:1c:48                                                   \u2502      \u2502\n\u2502            \u2502     NetworkInterfaceId: eni-06e9d87ff776cf40f                                       \u2502      \u2502\n\u2502            \u2502     OwnerId: 840541460064                                                           \u2502      \u2502\n\u2502            \u2502     PrivateDnsName: ip-172-31-2-146.eu-west-2.compute.internal                      \u2502      \u2502\n\u2502            \u2502     PrivateIpAddress: 172.31.2.146                                                  \u2502      \u2502\n\u2502            \u2502     PrivateIpAddresses:                                                             \u2502      \u2502\n\u2502            \u2502       - Association:                                                                \u2502      \u2502\n\u2502            \u2502           IpOwnerId: amazon                                                         \u2502      \u2502\n\u2502            \u2502           PublicDnsName: ec2-18-132-98-216.eu-west-2.compute.amazonaws.com          \u2502      \u2502\n\u2502            \u2502           PublicIp: 18.132.98.216                                                   \u2502      \u2502\n\u2502            \u2502         Primary: true                                                               \u2502      \u2502\n\u2502            \u2502         PrivateDnsName: ip-172-31-2-146.eu-west-2.compute.internal                  \u2502      \u2502\n\u2502            \u2502         PrivateIpAddress: 172.31.2.146                                              \u2502      \u2502\n\u2502            \u2502     SourceDestCheck: true                                                           \u2502      \u2502\n\u2502            \u2502     Status: in-use                                                                  \u2502      \u2502\n\u2502            \u2502     SubnetId: subnet-0f6f085fc384bf8ce                                              \u2502      \u2502\n\u2502            \u2502     VpcId: vpc-bbbafcd3                                                             \u2502      \u2502\n\u2502            \u2502     InterfaceType: interface                                                        \u2502      \u2502\n\u2502            \u2502 RootDeviceName: /dev/sda1                                                           \u2502      \u2502\n\u2502            \u2502 RootDeviceType: ebs                                                                 \u2502      \u2502\n\u2502            \u2502 SecurityGroups:                                                                     \u2502      \u2502\n\u2502            \u2502   - GroupName: default                                                              \u2502      \u2502\n\u2502            \u2502     GroupId: sg-f4139a96                                                            \u2502      \u2502\n\u2502            \u2502 SourceDestCheck: true                                                               \u2502      \u2502\n\u2502            \u2502 Tags:                                                                               \u2502      \u2502\n\u2502            \u2502   - Key: Name                                                                       \u2502      \u2502\n\u2502            \u2502     Value: web-server                                                               \u2502      \u2502\n\u2502            \u2502   - Key: stage                                                                      \u2502      \u2502\n\u2502            \u2502     Value: dev                                                                      \u2502      \u2502\n\u2502            \u2502   - Key: CreatedByProvider                                                          \u2502      \u2502\n\u2502            \u2502     Value: aws                                                                      \u2502      \u2502\n\u2502            \u2502   - Key: ManagedBy                                                                  \u2502      \u2502\n\u2502            \u2502     Value: GruCloud                                                                 \u2502      \u2502\n\u2502            \u2502   - Key: projectName                                                                \u2502      \u2502\n\u2502            \u2502     Value: ec2-simple                                                               \u2502      \u2502\n\u2502            \u2502 VirtualizationType: hvm                                                             \u2502      \u2502\n\u2502            \u2502 CpuOptions:                                                                         \u2502      \u2502\n\u2502            \u2502   CoreCount: 1                                                                      \u2502      \u2502\n\u2502            \u2502   ThreadsPerCore: 2                                                                 \u2502      \u2502\n\u2502            \u2502 CapacityReservationSpecification:                                                   \u2502      \u2502\n\u2502            \u2502   CapacityReservationPreference: open                                               \u2502      \u2502\n\u2502            \u2502 HibernationOptions:                                                                 \u2502      \u2502\n\u2502            \u2502   Configured: false                                                                 \u2502      \u2502\n\u2502            \u2502 Licenses: []                                                                        \u2502      \u2502\n\u2502            \u2502 MetadataOptions:                                                                    \u2502      \u2502\n\u2502            \u2502   State: applied                                                                    \u2502      \u2502\n\u2502            \u2502   HttpTokens: optional                                                              \u2502      \u2502\n\u2502            \u2502   HttpPutResponseHopLimit: 1                                                        \u2502      \u2502\n\u2502            \u2502   HttpEndpoint: enabled                                                             \u2502      \u2502\n\u2502            \u2502 EnclaveOptions:                                                                     \u2502      \u2502\n\u2502            \u2502   Enabled: false                                                                    \u2502      \u2502\n\u2502            \u2502                                                                                     \u2502      \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\nList Summary:\nProvider: aws\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 aws                                                                                                    \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 EC2                \u2502 web-server                                                                        \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n1 resource, 7 types, 1 provider\nCommand "gc l -o" executed in 7s\n')),Object(c.b)("blockquote",null,Object(c.b)("p",{parentName:"blockquote"},"Note that tags have been added to the EC2 Instance, it gives GruCloud a way to identify the resources under its control. Unlike other infrastructure as code tools such as Terraform and Pulumi, GruCloud does not need a ",Object(c.b)("em",{parentName:"p"},"state")," file. Hence removing a lot of complexity and issues.")),Object(c.b)("h3",{id:"update"},"Update"),Object(c.b)("p",null,"The ec2 instance configuration might change, for instance, let's modify the machine type to ",Object(c.b)("inlineCode",{parentName:"p"},"t3.micro")," located in ",Object(c.b)("em",{parentName:"p"},"config.js")),Object(c.b)("p",null,"The ",Object(c.b)("inlineCode",{parentName:"p"},"plan")," command is a read-only command which fetches the live resources and compares them with the target resources defined in the code."),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-sh"},"gc plan\n")),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-txt"},'Querying resources on 1 provider: aws\n\u2713 aws\n  \u2713 Initialising\n  \u2713 Listing 13/13\n  \u2713 Querying\n    \u2713 EC2 1/1\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 1 EC2 from aws                                                                           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 Name       \u2502 Action   \u2502 Data                                                             \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 web-server \u2502 UPDATE   \u2502 added:                                                           \u2502\n\u2502            \u2502          \u2502 updated:                                                         \u2502\n\u2502            \u2502          \u2502   InstanceType: t3.micro                                         \u2502\n\u2502            \u2502          \u2502                                                                  \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 Plan summary for provider aws                                                           \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 DEPLOY RESOURCES                                                                        \u2502\n\u251c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u252c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2524\n\u2502 EC2                \u2502 web-server                                                         \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2534\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n1 resource to deploy on 1 provider\nCommand "gc plan" executed in 5s\n')),Object(c.b)("p",null,"Let's apply the change:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-sh"},"gc apply\n")),Object(c.b)("blockquote",null,Object(c.b)("p",{parentName:"blockquote"},"Bear in mind that the machine requires to be stopped and restarted.")),Object(c.b)("p",null,"Trust but verify, hence, list the EC2 instances and check the ",Object(c.b)("inlineCode",{parentName:"p"},"InstanceType")," has been changed."),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-sh"},"gc l -t EC2\n")),Object(c.b)("h3",{id:"output"},"Output"),Object(c.b)("p",null,"Another useful command is ",Object(c.b)("em",{parentName:"p"},"gc output"),", which extract information for a specific field of a given resource"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"gc output -t EC2 --name web-server -f InstanceType\n")),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-txt"},"t3.micro\n")),Object(c.b)("p",null,"Nested field can be accessed too, for example, let's retrieve the public IP address attached to the EC2 instance:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-sh"},"gc output -t EC2 --name web-server -f 'NetworkInterfaces[0].Association.PublicIp'\n")),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-txt"},"18.130.34.212\n")),Object(c.b)("p",null,"The temptation to ping is high:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-sh"},"ping `gc output -t EC2 --name web-server -f 'NetworkInterfaces[0].Association.PublicIp'`\n")),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-txt"},"PING 18.130.34.212 (18.130.34.212): 56 data bytes\n64 bytes from 18.130.34.212: icmp_seq=0 ttl=38 time=153.799 ms\n64 bytes from 18.130.34.212: icmp_seq=1 ttl=38 time=153.583 ms\n64 bytes from 18.130.34.212: icmp_seq=2 ttl=38 time=140.622 ms\n")),Object(c.b)("h3",{id:"destroy"},"Destroy"),Object(c.b)("p",null,"Time to destroy the resources allocated and therefore save a lot of \xa3$\u20ac."),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre",className:"language-bash"},"gc destroy\n")),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"Find Deletable resources on 1 provider: aws\n\u2713 aws\n  \u2713 Initialising\n  \u2713 Listing 6/6\n? Are you sure to destroy 1 resource, 1 type on 1 provider? \u203a (y/N)\n\n")),Object(c.b)("p",null,"Once again, you are given the opportunity to look at what is going to be destroyed.\nType 'y' to confirm the destruction:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},'Destroying resources on 1 provider: aws\n\u2713 aws\n  \u2713 Initialising\n  \u2713 Destroying\n    \u2713 EC2 1/1\n1 resource destroyed, 1 type on 1 provider\nRunning OnDestroyedGlobal resources on 1 provider: aws\nCommand "gc destroy" executed in 1m 29s\n')),Object(c.b)("p",null,"Let's run the ",Object(c.b)("inlineCode",{parentName:"p"},"gc list")," command with the ",Object(c.b)("inlineCode",{parentName:"p"},"E2")," filter to verify the EC2 is gone:"),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"gc l -t EC2\n")),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},'Listing resources on 1 provider: aws\n\u2713 aws\n  \u2713 Initialising\n  \u2713 Listing 6/6\nList Summary:\nProvider: aws\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502 aws                                                                     \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n0 resources, 0 types, 1 provider\nCommand "gc list -t EC2" executed in 3s\n')),Object(c.b)("p",null,"This example demonstrates how to code a very basic infrastructure with one EC2 instance, and how can we use the ",Object(c.b)("inlineCode",{parentName:"p"},"gc apply"),", ",Object(c.b)("inlineCode",{parentName:"p"},"gc list"),", ",Object(c.b)("inlineCode",{parentName:"p"},"gc destroy")," and ",Object(c.b)("inlineCode",{parentName:"p"},"gc graph")," to manage the infrastructure."),Object(c.b)("p",null,"It paves the way for more ",Object(c.b)("a",{parentName:"p",href:"https://www.grucloud.com/docs/aws/AwsExamples"},"AWS examples")),Object(c.b)("h3",{id:"graph"},"Graph"),Object(c.b)("p",null,"A picture is worth a thousand words, GruCloud generates an SVG file describing the resources and their relationship."),Object(c.b)("pre",null,Object(c.b)("code",{parentName:"pre"},"gc graph\n")),Object(c.b)("p",null,"Here is the graph of a typical web application managed by Kubernetes running on AWS where the master node is managed by EKS."),Object(c.b)("p",null,Object(c.b)("img",{parentName:"p",src:"https://raw.githubusercontent.com/grucloud/grucloud/main/examples/starhackit/eks-lean/diagram-target.svg",alt:"kubernetes eks"})))}p.isMDXComponent=!0},197:function(e,n,t){"use strict";t.d(n,"a",(function(){return u})),t.d(n,"b",(function(){return m}));var a=t(0),r=t.n(a);function c(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function o(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function i(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?o(Object(t),!0).forEach((function(n){c(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):o(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function s(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},c=Object.keys(e);for(a=0;a<c.length;a++)t=c[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);for(a=0;a<c.length;a++)t=c[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var l=r.a.createContext({}),p=function(e){var n=r.a.useContext(l),t=n;return e&&(t="function"==typeof e?e(n):i(i({},n),e)),t},u=function(e){var n=p(e.components);return r.a.createElement(l.Provider,{value:n},e.children)},b={inlineCode:"code",wrapper:function(e){var n=e.children;return r.a.createElement(r.a.Fragment,{},n)}},d=r.a.forwardRef((function(e,n){var t=e.components,a=e.mdxType,c=e.originalType,o=e.parentName,l=s(e,["components","mdxType","originalType","parentName"]),u=p(t),d=a,m=u["".concat(o,".").concat(d)]||u[d]||b[d]||c;return t?r.a.createElement(m,i(i({ref:n},l),{},{components:t})):r.a.createElement(m,i({ref:n},l))}));function m(e,n){var t=arguments,a=n&&n.mdxType;if("string"==typeof e||a){var c=t.length,o=new Array(c);o[0]=d;var i={};for(var s in n)hasOwnProperty.call(n,s)&&(i[s]=n[s]);i.originalType=e,i.mdxType="string"==typeof e?e:a,o[1]=i;for(var l=2;l<c;l++)o[l]=t[l];return r.a.createElement.apply(null,o)}return r.a.createElement.apply(null,t)}d.displayName="MDXCreateElement"}}]);